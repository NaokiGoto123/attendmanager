<div class="spinner-container" *ngIf="initialLoading">
  <mat-spinner></mat-spinner>
</div>

<ng-container *ngIf="!initialLoading">
  <div *ngIf="!events?.length">
    <div class="no-event-container" *ngIf="groups?.length">
      <div class="no-event-container__left">
        <img
          class="no-event-container__left__image"
          src="/assets/images/schedule1.svg"
          alt="no event image"
        />
      </div>
      <div class="no-event-container__right">
        <p>You do not have any events.</p>
        <p routerLink="/search/events">Search for events</p>
        <p>or</p>
        <p routerLink="/create-event">Create event</p>
      </div>
    </div>

    <div class="no-group-container" *ngIf="!groups?.length">
      <div class="no-group-container__left">
        <img
          class="no-group-container__left__image"
          src="/assets/images/team1.svg"
          alt="no group image"
        />
      </div>
      <div class="no-group-container__right">
        <p>You do not belong to any groups.</p>
        <p routerLink="/search/groups">Search for groups</p>
        <p>or</p>
        <p routerLink="/create-group">Create group</p>
      </div>
    </div>
  </div>

  <div class="container" *ngIf="events?.length">
    <mat-toolbar class="toolbar">
      <ng-container [formGroup]="form">
        <mat-checkbox
          *ngFor="let group of groups"
          [formControlName]="group.id"
          class="toolbar__checkbox"
          >{{ group.name }}
        </mat-checkbox>
      </ng-container>
    </mat-toolbar>

    <div class="header-container">
      <div class="buttons-container">
        <button
          mat-fab
          class="buttons-container__button"
          color="primary"
          routerLink="/create-event"
        >
          <mat-icon>add</mat-icon>
        </button>
        <button
          mat-fab
          class="buttons-container__button"
          color="accent"
          routerLink="/calendar"
        >
          <mat-icon>calendar_today</mat-icon>
        </button>
        <button
          mat-fab
          class="buttons-container__button"
          color="accent"
          (click)="toggleView()"
        >
          <mat-icon>list</mat-icon>
        </button>
      </div>

      <form
        class="search-field-container"
        (ngSubmit)="querySearch(valueControl.value, searchOptions)"
      >
        <mat-form-field class="search-field" appearance="outline">
          <mat-label>Search from your events</mat-label>

          <input
            matInput
            type="text"
            [formControl]="valueControl"
            autocomplete="off"
            [matAutocomplete]="auto"
          />

          <mat-autocomplete
            autoActiveFirstOption
            (optionSelected)="querySearch(valueControl.value, searchOptions)"
            #auto="matAutocomplete"
          >
            <mat-option *ngFor="let option of options" [value]="option.title">
              {{ option.title }}
            </mat-option>
          </mat-autocomplete>

          <button
            mat-button
            *ngIf="valueControl.value"
            matSuffix
            mat-icon-button
            aria-label="Clear"
            type="button"
            (click)="
              clearSearch(); querySearch(valueControl.value, searchOptions)
            "
          >
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>
      </form>
    </div>
    <mat-progress-bar
      class="progress-bar"
      mode="indeterminate"
      *ngIf="loading"
    ></mat-progress-bar>

    <div class="events-container" *ngIf="!listView">
      <app-events-and-detail
        [events]="items"
        (scrolls)="additionalSearch()"
      ></app-events-and-detail>
    </div>

    <ng-container *ngIf="listView">
      <app-events-list-view
        [events]="items"
        [existence]="items?.length"
        (more)="additionalSearch()"
      >
      </app-events-list-view>
    </ng-container>
  </div>
</ng-container>
